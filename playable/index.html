<!DOCTYPE html>
<html lang="en">
<head>
	<title>Crada Playable</title>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta
		name="viewport"
		content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, width=device-width, height=device-height, viewport-fit=cover, user-scalable=no"
	/>
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<style>
		* {
			padding: 0;
			margin: 0;
		}
		
		div {
			display: block;
		}
		
		html,
		body {
			position: relative;
			background: #67b735;
			display: block;
			width: 100%;
			height: 100vh;
			overflow: hidden;
			margin: 0;
			-webkit-user-select: none;
			user-select: none;
		}
		
		canvas {
			position: relative;
			background: transparent;
			-webkit-user-select: none;
			user-select: none;
		}
		
		#main {
			left: 0;
			top: 0;
			right: 0;
			bottom: 0;
		}
		
		#main,
		#main>div {
			position: absolute;
			left: 0;
			top: 0;
		}
		
		#main>div {
			opacity: 0;
			transition: opacity .5s;
		}
		
		#main>div.visible {
			opacity: 1;
		}
		
		#loader {
			position: absolute;
			left: 50%;
			top: 50%;
			margin-left: -45px;
			margin-top: -45px;
			width: 60px;
			aspect-ratio: 1;
			border: 15px solid #ddd;
			border-radius: 50%;
			transform: rotate(45deg);
		}
		
		#loader.hidden {
			opacity: 0;
			transition: opacity .6s .6s;
		}
		
		#loader::before {
			content: "";
			position: absolute;
			inset: -15px;
			border-radius: 50%;
			border: 15px solid #8223fc;
			animation: l18 2s infinite linear;
		}
		
		@keyframes l18 {
			0%   {clip-path:polygon(50% 50%,0 0,0    0,0    0   ,0    0   ,0    0   )}
			25%  {clip-path:polygon(50% 50%,0 0,100% 0,100% 0   ,100% 0   ,100% 0   )}
			50%  {clip-path:polygon(50% 50%,0 0,100% 0,100% 100%,100% 100%,100% 100%)}
			75%  {clip-path:polygon(50% 50%,0 0,100% 0,100% 100%,0    100%,0    100%)}
			100% {clip-path:polygon(50% 50%,0 0,100% 0,100% 100%,0    100%,0    0   )}
		}
	
	</style>
</head>

<body ondragstart="return false;" ondrop="return false;">
<div id="main">
	<div id="canvas3d"></div>
	<div id="canvas2d"></div>
</div>

<script>
	window.addEventListener('load', initApplication);
	
	function initApplication() {
		window.removeEventListener('load', initApplication);
		
		// Ждем, пока app будет создан в index.mjs
		const checkApp = () => {
			if (typeof app !== 'undefined') {
				app.settings.store = {
					ios: 'blank',
					android: 'blank'
				};
				app.settings.titleKey = 'playable';
				app.settings.language = 'en';
				app.settings.platform = 'dev';
				Object.freeze(app.settings);
				
				app.init();
				
				globalThis.__PIXI_APP__ = app.pixi.app;
				
				// PIXIDevTool для разработки
				if (typeof PIXIDevTool !== 'undefined') {
					new PIXIDevTool();
				}
			} else {
				// Если app еще не создан, ждем еще немного
				setTimeout(checkApp, 100);
			}
		};
		
		checkApp();
	}
</script>

<script type="module" src="./index.mjs"></script>
</body>
</html>
